{"version":3,"file":"xloader.js","sources":["webpack:///webpack/bootstrap ee1165809a6f3b1bcac1?85a9","src/index.js","webpack:///src/util.js?34a6","webpack:///src/log.js?4f24","webpack:///./~/.npminstall/process/0.11.2/process/browser.js?6fc6","webpack:///src/event.js?031b","webpack:///src/config.js?9d9a","webpack:///src/klass.js?d226","webpack:///src/define.js?4e05","webpack:///src/require.js?0936","webpack:///src/assets.js?15c8","src/loader.js","src/request.js"],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap ee1165809a6f3b1bcac1\n **/","'use strict';\n\n\nconst util = require('./util');\nconst log = require('./log');\nconst Loader = require('./loader');\n\n\n/* eslint no-underscore-dangle: 0 */\n\n\nconst loader = module.exports = {};\n\nloader.new = function(namespace, options) {\n  return new Loader(namespace, options);\n};\n\nloader.log = log;\n\n\nconst x = loader.new('x', { autoloadAnonymous: true });\n\n\nconst methods = [\n  'config', 'on', 'off', 'define', 'require',\n  'hasDefine', 'getModules', 'resolve', 'undefine'\n];\n\n\nutil.each(methods, function(index, name) {\n  loader[name] = x[name];\n});\n\n\nx.define('global', function() {\n  return global;\n});\n\n\nif (process.browser) {\n  const originDefine = global.define;\n  const originRequire = global.require;\n  const originLoader = global.xloader;\n\n  loader.noConflict = function(deep) {\n    global.define = originDefine;\n    global.require = originRequire;\n    if (deep) {\n      global.xloader = originLoader;\n    }\n    return loader;\n  };\n\n  loader.assets = require('./assets');\n\n  global.xloader = loader;\n  global.define = loader.define;\n  global.require = loader.require;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** src/index.js\n **/","'use strict';\n\n\nconst toString = Object.prototype.toString;\nlet guid = 1;\n\n\nexports.isArray = Array.isArray ? Array.isArray : isArray\n\n\nexports.__test = {\n  isArray: isArray\n};\n\n\nfunction isArray(o) {\n  return toString.call(o) === '[object Array]';\n}\n\n\nexports.extend = function(des, src) {\n  for (const k in src) {\n    const v = src[k];\n    if (v !== null && v !== undefined) {\n      des[k] = v;\n    }\n  }\n  return des;\n};\n\n\nexports.each = function(iter, fn) {\n  const len = iter.length;\n  const isArrayLike = len === 0 ||\n      (typeof len === 'number' && len > 0 && (len - 1) in iter);\n\n  if (isArrayLike) {\n    for (let i = 0; i < len; i++) {\n      fn(i, iter[i]);\n    }\n  } else {\n    for (const k in iter) {\n      fn(k, iter[k]);\n    }\n  }\n};\n\n\nexports.map = function(list, fn) {\n  const ret = [];\n  for (let i = 0, c = list.length; i < c; i++) {\n    const v = fn(i, list[i]);\n    v !== undefined && ret.push(v);\n  }\n  return ret;\n};\n\n\nexports.proxy = function(o, name) {\n  const fn = o[name];\n  return function() {\n    return fn.apply(o, arguments);\n  };\n};\n\n\nexports.assert = function(test, message) {\n  if (!test) {\n    throw new Error('AssertFailError: ' + message);\n  }\n};\n\n\nexports.guid = function() {\n  return guid++;\n};\n\n\nconst rParent = /([-\\w]+\\/\\.\\.\\/)/g;\nconst rCurrent = /([^.])\\.\\//g;\n\nexports.join = function(parent, path) {\n  path = parent ? parent + '/' + path : path;\n  path = path.replace(rCurrent, '$1');\n  while (rParent.test(path)) {\n    path = path.replace(rParent, '');\n  }\n  return path;\n};\n\n\nconst rLastSlash = /\\/$/;\nexports.dirname = function(path) {\n  path = path.replace(rLastSlash, '');\n  const pos = path.lastIndexOf('/');\n  return pos === -1 ? '' : path.substr(0, pos);\n};\n\n\n\n/** WEBPACK FOOTER **\n ** src/util.js\n **/","'use strict';\n\n\n/* eslint no-console: 0 */\n\n\nconst util = require('./util');\n\n\nconst LEVEL = { none: 0, error: 1, warn: 2, info: 3, debug: 4 };\nconst slice = [].slice;\n\n\nconst log = module.exports = {};\n\n\nlog.level = 'warn';\nlog.filter = false;\n\nlog.isEnabled = function(type) {\n  return LEVEL[type] <= LEVEL[log.level];\n};\n\n\nutil.each(LEVEL, function(type) {\n  log[type] = function() {\n    if (log.isEnabled(type)) {\n      const args = slice.call(arguments, 0);\n      if (!log.filter || log.filter(args[0])) {\n        args[0] = '[loader] ' + args[0];\n        log.handler(type, args);\n      }\n    }\n  };\n});\n\n\nlog.handler = typeof console !== 'undefined' ? function(type, args) {\n  if (console[type]) {\n    console[type].apply(console, args);\n  }\n} : function() {};\n\n\nlet filter = process.env.XLOADER_LOG;   // eslint-disable-line\nif (process.browser) {\n  const re = /\\bxloader\\.log=([^&]+)/;\n  const match = re.exec(window.location.search); // eslint-disable-line\n  filter = match && match[1];\n}\n\nif (filter) {\n  log.level = 'debug';\n  filter = filter\n      .replace(/([.\\[\\]\\(\\)\\{\\}^$\\\\?+])/g, '\\\\$1')\n      .replace(/\\*/g, '.*');\n  const rFilter = new RegExp('^' + filter + '$');\n  log.filter = function(text) {\n    return rFilter.test(text);\n  };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** src/log.js\n **/","// shim for using process in browser\n\nvar process = module.exports = {};\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = setTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    clearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        setTimeout(drainQueue, 0);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/.npminstall/process/0.11.2/process/browser.js\n ** module id = 6\n ** module chunks = 0 1\n **/","'use strict';\n\n\nconst log = require('../src/log');\n\n\nconst slice = [].slice;\n\n\nmodule.exports = function(target) {\n  const cache = {};\n\n  target = target || {};\n\n  target.on = function(name, fn) {\n    log.debug('event.on: ' + name, fn);\n    const list = cache[name] || (cache[name] = []);\n    list.push(fn);\n  };\n\n\n  target.trigger = function(name) {\n    const list = cache[name];\n    if (list) {\n      const params = arguments.length > 1 ? slice.call(arguments, 1) : [];\n      log.debug('event.trigger: ' + name, params);\n      for (let i = 0, c = list.length; i < c; i++) {\n        const result = list[i].apply(target, params);\n        if (result !== null && result !== undefined) {\n          return result;\n        }\n      }\n    }\n  };\n\n\n  target.off = function(name, fn) {\n    log.debug('event.off: ' + name, fn);\n\n    const list = cache[name];\n    if (list) {\n      for (let i = list.length - 1; i >= 0; i--) {\n        if (list[i] === fn) {\n          list.splice(i, 1);\n        }\n      }\n      if (!list.length) {\n        delete cache[name];\n      }\n    }\n  };\n\n\n  return target;\n};\n//~\n\n\n\n/** WEBPACK FOOTER **\n ** src/event.js\n **/","'use strict';\n\n\nconst klass = require('./klass');\nconst log = require('./log');\n\nconst listFields = { alias: true, resolve: true };\n\n\nmodule.exports = klass({\n  init: function() {\n    this.cache = {};\n  },\n\n\n  get: function(name) {\n    const cache = this.cache;\n    return listFields[name] ? (cache[name] || []) : cache[name];\n  },\n\n\n  set: function(name, value) {\n    log.debug('set config: ' + name, value);\n    const cache = this.cache;\n    if (listFields[name]) {\n      cache[name] = cache[name] || [];\n      cache[name].push(value);\n    } else {\n      cache[name] = value;\n    }\n  }\n});\n\n\n\n/** WEBPACK FOOTER **\n ** src/config.js\n **/","'use strict';\n\n\nconst util = require('./util');\n\n\nmodule.exports = function(proto) {\n  const klass = function() {\n    const init = this.init;\n    return init && init.apply(this, arguments);\n  };\n\n  proto && util.extend(klass.prototype, proto);\n\n  return klass;\n};\n\n\n\n/** WEBPACK FOOTER **\n ** src/klass.js\n **/","'use strict';\n\n\nconst util = require('./util');\nconst log = require('./log');\nconst klass = require('./klass');\n\n\nmodule.exports = klass({\n  init: function(loader) {\n    this.loader = loader;\n  },\n\n\n  define: function(id, depends, factory) {\n    const loader = this.loader;\n    const modules = loader.modules;\n\n    const module = regular(id, depends, factory);\n    id = module.id;\n\n    if (modules[id]) {\n      log.warn('module already defined, ignore: ' + id);\n      return modules[id];\n    }\n\n    log.debug('define module: ' + id, module);\n    modules[id] = module;\n\n    loader.trigger('define', module);\n\n    return module;\n  }\n});\n\n\n\n/**\n * define(id, depends, factory)\n * define(id, factory{not array})\n * define(id, depends{array})\n * define(depends{array}, factory)\n * define(factory{function})\n */\nconst assert = util.assert;\nconst isArray = util.isArray;\nconst EMPTY = [];\n\nfunction regular(id, depends, factory) {\n  if (factory === undefined && !isArray(depends)) {\n    factory = depends;\n    depends = EMPTY;\n  }\n\n  if (typeof id === 'function') {\n    factory = id;\n    depends = EMPTY;\n    id = null;\n  } else if (isArray(id)) {\n    depends = id;\n    id = null;\n  }\n\n  assert(isArray(depends), 'arguments error, depends should be an array');\n\n  const anonymous = !id;\n  id = id || '____anonymous' + util.guid();\n\n  return { id: id, depends: depends, factory: factory, anonymous: anonymous };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** src/define.js\n **/","'use strict';\n\n\nconst klass = require('./klass');\nconst util = require('./util');\nconst log = require('./log');\n\n\nconst assert = util.assert;\n\n\nmodule.exports = klass({\n  init: function(loader) {\n    this.loader = loader;\n    this.aliasCache = {};\n  },\n\n\n  require: function(depends, callback) {\n    depends = util.isArray(depends) ? depends : [depends];\n\n    const module = {\n      proxy: true,\n      id: '____require' + util.guid(),\n      depends: depends,\n      factory: function() {\n        return arguments;\n      }\n    };\n\n    load(this, module, function() {\n      callback && callback.apply(null, module.exports);\n    });\n\n    return module.exports && module.exports[0];\n  }\n});\n\n\n\nfunction load(self, module, callback) {\n  log.debug('init module: ' + module.id);\n\n  if (module.loadtimes > 0) {\n    module.loadtimes++;\n    log.debug(module.id + ' is loaded', module.exports);\n    callback();\n    return;\n  }\n\n  const loadlist = module.loadlist || (module.loadlist = []);\n  loadlist.push(callback);\n  if (loadlist.length > 1) {\n    log.debug('module is in loading: ' + module.id);\n    return;\n  }\n\n  loadDepends(self, module, function() {\n    compile(self, module, function() {\n      log.debug(module.id + ' is loaded', module.exports);\n      module.loadtimes = loadlist.length;\n      delete module.loadlist;\n      util.each(loadlist, function(index, fn) {\n        fn();\n      });\n    });\n  });\n}\n//~ load\n\n\nconst rRelative = /^\\.\\.?\\//;\n\n\nfunction loadDepends(self, module, callback) {\n  const loader = self.loader;\n  const modules = loader.modules;\n\n  const depends = module.depends;\n  if (depends.length === 0) {\n    return callback();\n  }\n\n  const adepends = module.adepends = [];\n  const rpath = util.dirname(module.id);\n  util.each(depends, function(index, id) {\n    adepends[index] = rRelative.test(id) ? util.join(rpath, id) : id;\n  });\n\n\n  log.debug('try load depends for: ' + module.id, adepends);\n\n  // 并行加载依赖模块\n  const n = adepends.length;\n  let count = 0;\n\n  const aliasCache = self.aliasCache;\n\n  util.each(adepends, function(index, id) {\n    const aid = aliasCache[id] || loader.trigger('alias', id);\n    if (aid && id !== aid) {\n      log.debug('alias ' + id + ' -> ' + aid);\n      id = aid;\n      aliasCache[id] = id;\n      adepends[index] = id;\n    }\n\n    let called = false;\n    const cb = function() {\n      // istanbul ignore if\n      if (called) {\n        log.error('depend already loaded: ' + id);\n        return;\n      }\n      called = true;\n      count++;\n      count >= n && callback();\n    };\n\n    // 依赖的模块不需要异步加载\n    const o = modules[id];\n    if (o) {\n      load(self, o, cb);\n      return;\n    }\n\n    // 依赖的模块是异步加载\n    loadAsync(self, id, function(lo) {\n      load(self, lo, cb);\n    }, function(reason) {\n      const e = new Error('load dependency error, ' +\n                    module.id + ' -> ' + id + ', reason: ' + reason);\n      loader.trigger('error', e);\n    });\n  });\n}\n//~ loadDepends\n\n\nfunction compile(self, module, callback) {\n  const loader = self.loader;\n  const modules = loader.modules;\n\n  loader.trigger('compile', module);\n\n  let factory = module.factory;\n  if (typeof factory === 'function') {\n    const depends = module.adepends;\n    const proxy = { id: module.id, exports: {} };\n    const list = [];\n\n    depends && depends.length &&\n    util.each(depends, function(index, id) {\n      const o = modules[id];\n      assert((o && ('exports' in o)), 'module should already loaded: ' + id);\n      if (o.exports && typeof o.exports.$compile === 'function') {\n        list[index] = o.exports.$compile(proxy, module);\n      } else {\n        list[index] = o.exports;\n      }\n    });\n\n    try {\n      log.debug('compile ' + module.id, module);\n      factory = factory.apply(null, list);\n      if (factory === undefined) {\n        factory = proxy.exports;\n      }\n    } catch (e) {\n      factory = null;\n      loader.trigger('error', e);\n    }\n  }\n\n  module.exports = factory;\n  callback();\n}\n//~ compile\n\n\nconst requestList = {};\n\nfunction loadAsync(self, id, callback, error) {\n  const loader = self.loader;\n  const modules = loader.modules;\n\n  const url = loader.trigger('resolve', id);\n  if (!url) {\n    error('can not resolve module: ' + id);\n    return;\n  }\n\n  log.debug('resolve ' + id + ' -> ' + url);\n\n  const list = requestList[id] || (requestList[id] = []);\n\n  const cb = function() {\n    const o = modules[id];\n    if (!o) {\n      error('can not find module: ' + id);\n      return;\n    }\n\n    o.async = true;\n    o.url = url;\n    callback(o);\n  };\n\n  list.push(cb);\n  if (list.length > 1) {\n    return;\n  }\n\n  const options = {\n    id: id,\n    url: url,\n    namespace: loader.namespace\n  };\n\n  log.debug('try request: ' + url);\n  loader.trigger('request', options, function() {\n    delete requestList[id];\n    util.each(list, function(index, fn) {\n      fn();\n    });\n  });\n}\n//~ loadAsync\n\n\n\n/** WEBPACK FOOTER **\n ** src/require.js\n **/","'use strict';\n\n\nconst log = require('./log');\n\n\n/* global window, document */\n\n\nconst rCss = /\\.css(\\?|$)/;\n\n\nexports.load = function(url, options) {\n  const type = rCss.test(url) ? 'css' : 'script';\n  return exports[type](url, options);\n};\n\n\nexports.script = function(url, options) {\n  options = options || {};\n\n  const node = doc.createElement('script');\n  const removeNode = !log.isEnabled('debug');\n\n  onLoadAssets(node, url, removeNode, options);\n\n  if (options.async !== false) {\n    node.async = 'async';\n  }\n  if (options.id) {\n    node.setAttribute('data-id', options.id);\n  }\n  if (options.namespace) {\n    node.setAttribute('data-namespace', options.namespace);\n  }\n  node.src = url;\n\n  if (options.charset) {\n    node.charset = options.charset;\n  }\n\n  append(node);\n};\n//~ script\n\n\nconst rWebKit = /.*webkit\\/?(\\d+)\\..*/;\nconst rMobile = /mobile/;\n\nconst UA = window.navigator.userAgent.toLowerCase();\nconst webkitVersion = rWebKit.exec(UA);\nconst isOldWebKit = webkitVersion ? webkitVersion[1] * 1 < 536 : false;\nconst isPollCSS = isOldWebKit || (!webkitVersion && rMobile.test(UA));\n\n\nexports.css = function(url, options) {\n  options = options || {};\n\n  const node = doc.createElement('link');\n\n  node.rel = 'stylesheet';\n  node.href = url;\n\n  if (options.charset) {\n    node.charset = options.charset;\n  }\n\n  if (!('onload' in node) || isPollCSS) {\n    setTimeout(function() {\n      poll(node, options);\n    }, 1);\n  } else {\n    onLoadAssets(node, url, false, options);\n  }\n\n  append(node);\n};\n//~ css\n\n\nconst rLoadSheetError = /security|denied/i;\nfunction poll(node, options) {\n  let flag = false;\n\n  setTimeout(function() {\n    if (!flag) {\n      flag = true;\n      options.error && options.error(new Error('poll request css timeout'));\n    }\n  }, options.timeout || 10000);\n\n  const fn = function() {\n    let isLoaded = false;\n    try {\n      isLoaded = !!node.sheet;\n    } catch (e) {\n      isLoaded = rLoadSheetError.test(e.message);\n    }\n\n    if (!flag) {\n      if (isLoaded) {\n        flag = true;\n        options.success && options.success();\n      } else {\n        setTimeout(fn, 20);\n      }\n    }\n  };\n\n  fn();\n}\n\n\nconst rReadyStates = /loaded|complete|undefined/;\n\n/* eslint max-params: [2, 5] */\nfunction onLoadAssets(node, url, removeNode, options, fn) {\n  node.onload = node.onreadystatechange = function(event) {\n    event = event || window.event || {};\n    if (event.type === 'load' || rReadyStates.test('' + node.readyState)) {\n      node.onload = node.onreadystatechange = node.onerror = null;\n      removeNode && head.removeChild(node);\n      fn && fn();\n      options.success && options.success();\n    }\n  };\n\n  node.onerror = function() {\n    node.onload = node.onreadystatechange = node.onerror = null;\n    const e = new Error('load assets error: ' + url);\n    options.error && options.error(e);\n  };\n}\n\n\nconst doc = document;\nconst head = doc.head ||\n    doc.getElementsByTagName('head')[0] ||\n    doc.documentElement;\nconst baseElement = doc.getElementsByTagName('base')[0];\n\nfunction append(node) {\n  baseElement ? head.insertBefore(node, baseElement) :\n      head.appendChild(node);\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** src/assets.js\n **/","'use strict';\n\n\nconst util = require('./util');\nconst log = require('./log');\nconst klass = require('./klass');\nconst Event = require('./event');\nconst Config = require('./config');\nconst Define = require('./define');\nconst Require = require('./require');\nconst Request = require('./request');\n\n\nmodule.exports = klass({\n  init: function(namespace, options) {\n    const ns = namespace;\n    const opt = options || {};\n\n    this.namespace = ns;\n    this.options = opt;\n\n    init(this);\n    handleError(this);\n    handleAlias(this);\n    handleResolve(this);\n    handleRequest(this);\n    defineSpecial(this);\n\n    opt.autoloadAnonymous && loadAnonymous(this);\n  }\n});\n\n\nfunction init(self) {\n  const modules = self.modules = {};\n\n  new Event(self);    // eslint-disable-line\n\n  const config = new Config();\n  const define = new Define(self);\n  const require = new Require(self);\n\n  if (log.isEnabled('debug')) {\n    self._config = config;\n    self._define = define;\n    self._require = require;\n  }\n\n  self.config = function(name, value) {\n    return value === undefined ? config.get(name) :\n        config.set(name, value);\n  };\n\n  self.define = util.proxy(define, 'define');\n  self.require = util.proxy(require, 'require');\n\n  self.hasDefine = function(id) {\n    return !!modules[id];\n  };\n\n  self.getModules = function() {\n    return modules;\n  };\n\n  self.resolve = function(id) {\n    return self.trigger('resolve', id);\n  };\n\n  self.undefine = function(id) {\n    delete modules[id];\n  };\n}\n\n\nfunction handleError(self) {\n  self.on('error', function(e) {\n    log.error(e.stack);\n  });\n}\n\n\nfunction handleAlias(self) {\n  self.on('alias', function(id) {\n    return filter(self.config('alias'), function(index, alias) {\n      return typeof alias === 'function' ? alias(id) : alias[id];\n    });\n  });\n}\n\n\nconst rAbs = /(^(\\w+:)?\\/\\/)|(^\\/)/;\n\nfunction handleResolve(self) {\n  self.on('resolve', function(id) {\n    let url = filter(self.config('resolve'), function(index, resolve) {\n      return resolve(id);\n    });\n\n    if (!url && rAbs.test(id)) {\n      url = id;\n    }\n\n    return url;\n  });\n}\n\n\nfunction handleRequest(self) {\n  const request = new Request(self);\n  self.on('request', function(options, callback) {\n    request.handle(options, callback);\n  });\n}\n\n\nfunction defineSpecial(self) {\n  self.define('require', function() {\n    return self.require;\n  });\n\n  self.define('module', function() {\n    return {\n      $compile: function(module) {\n        return module;\n      }\n    };\n  });\n\n  self.define('exports', function() {\n    return {\n      $compile: function(module) {\n        return module.exports;\n      }\n    };\n  });\n}\n\n\nfunction loadAnonymous(self) {\n  self.on('define', function(module) {\n    if (module.anonymous) {\n      log.debug('require anonymous module: ' + module.id);\n      self.require(module.id);\n    }\n  });\n}\n\n\nfunction filter(list, fn) {\n  if (!list || list.length === 0) {\n    return null;\n  }\n  for (let i = 0, c = list.length; i < c; i++) {\n    const v = fn(i, list[i]);\n    if (v) {\n      return v;\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** src/loader.js\n **/","'use strict';\n\n\nconst klass = require('./klass');\nconst util = require('./util');\nconst log = require('./log');\n\n\nconst rFile = /\\.\\w+(\\?|$)/;\n\n\nmodule.exports = klass({\n  init: function(loader) {\n    this.loader = loader;\n  },\n\n\n  handle: function(options, callback) {\n    const loader = this.loader;\n    const handler = loader.config('requestHandler');\n    if (handler) {\n      return handler.call(loader, options, callback);\n    }\n\n    if (!process.browser) {\n      throw new Error('requestHandler not exists');\n    }\n\n    const modules = loader.modules;\n    const id = options.id;\n    const url = options.url;\n\n    let opts = loader.config('requestOptions');\n    opts = typeof opts === 'function' ? opts(options) : opts;\n    opts = util.extend({ id: id, namespace: options.namespace }, opts);\n\n    opts.success = function() {\n      log.debug('request assets success: ' + url, options);\n      // define a proxy module for just url request\n      if (!modules[id] && rFile.test(id)) {\n        loader.define(id);\n        modules[id].file = true;\n      }\n      callback();\n    };\n\n    opts.error = function(e) {\n      log.debug('request assets error: ' + url, e);\n      loader.trigger('error', e, options);\n    };\n\n    log.debug('request assets: ' + url, options);\n    const assets = require('./assets');\n    assets.load(url, opts);\n  }\n});\n\n\n\n/** WEBPACK FOOTER **\n ** src/request.js\n **/"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACtCA;AACA;AAEA;AACA;AACA;AACA;;;AAKA;AACA;AACA;AACA;AADA;AACA;AAGA;AACA;AAEA;AACA;AAEA;AACA;AAKA;AACA;AADA;AACA;AAIA;AACA;AADA;AACA;AAIA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AANA;AACA;AAQA;AACA;AACA;AACA;AACA;AAlBA;AAAA;;;;;;;;ACvCA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AADA;AACA;AAIA;AACA;AADA;AACA;AAIA;AACA;AACA;AACA;AACA;AADA;AAFA;AAMA;AAPA;AACA;AAUA;AACA;AACA;AACA;AAEA;AACA;AACA;AADA;AADA;AAKA;AACA;AADA;AALA;AALA;AACA;AAgBA;AACA;AACA;AACA;AACA;AAFA;AAIA;AANA;AACA;AASA;AACA;AACA;AACA;AADA;AAFA;AACA;AAOA;AACA;AACA;AADA;AADA;AACA;AAMA;AACA;AADA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AANA;AACA;AASA;AACA;AACA;AACA;AACA;AAHA;;;;;;;;AC5FA;AACA;;;AAKA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AADA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAFA;AADA;AADA;AACA;AAYA;AACA;AACA;AADA;AADA;AACA;AAMA;AACA;AACA;AACA;AAFA;AAAA;AACA;AAKA;;AACA;AACA;AAGA;AACA;AACA;AADA;AANA;AAAA;;;;;;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC1FA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAFA;AAHA;AAFA;AACA;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AADA;AAKA;AACA;AADA;AANA;AAJA;AACA;AAgBA;AA5CA;;;;;;;;ACTA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AADA;AACA;AAIA;AACA;AACA;AAFA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AAJA;AAHA;AAZA;;;;;;ACTA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AARA;;;;;;;ACNA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AADA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AAjBA;AANA;AACA;;;;;;;;AAmCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAFA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AApBA;;;;;;;AChDA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAFA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAJA;AACA;AAQA;AACA;AADA;AACA;AAGA;AAhBA;AAPA;AACA;AA4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AACA;AAMA;AACA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAJA;AADA;AAjBA;;;AA+BA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAGA;AACA;AACA;AACA;AADA;AACA;AAIA;AACA;;AAjBA;AAoBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AACA;AAMA;AACA;;AAEA;AACA;AACA;AAFA;AAIA;AACA;AACA;AARA;AACA;;AAXA;AAuBA;AACA;AACA;AAFA;AACA;;AAxBA;AA8BA;AADA;AAGA;AAEA;AAHA;AA/BA;AAxBA;;;AAiEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AADA;AAGA;AAHA;AAHA;AACA;AASA;AACA;AACA;AACA;AACA;AADA;AAHA;AAOA;AACA;AAFA;AAtBA;AAAA;AACA;AA2BA;AACA;AApCA;;;AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AATA;AACA;AAWA;AACA;AACA;AADA;AACA;AAGA;AACA;AACA;AACA;AAHA;AACA;AAKA;AACA;AACA;AACA;AACA;AADA;AAFA;AAtCA;;;;;;;;ACtLA;AACA;AAEA;AACA;;;AAKA;AACA;AAEA;AACA;AACA;AAFA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AADA;AAGA;AACA;AADA;AAGA;AACA;AACA;AACA;AADA;AACA;AAGA;AAvBA;;;AA4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAGA;AACA;AACA;AADA;AADA;AAKA;AALA;AACA;AAOA;AApBA;;;AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AADA;AACA;AAMA;AACA;AACA;AACA;AADA;AAGA;AADA;AACA;AAGA;AACA;AACA;AACA;AAFA;AAIA;AAJA;AADA;AARA;AACA;AAiBA;AA5BA;AACA;AA+BA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAFA;AACA;AASA;AACA;AACA;AACA;AAHA;AAXA;AACA;AAkBA;AACA;AAGA;AACA;AACA;AACA;AADA;;;;;;;AC7IA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AADA;AACA;AAmBA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AACA;AAKA;AACA;AADA;AACA;AAIA;AACA;AACA;AACA;AACA;AADA;AACA;AAGA;AACA;AADA;AACA;AAGA;AACA;AADA;AACA;AAGA;AACA;AADA;AAnCA;AACA;AAwCA;AACA;AACA;AADA;AADA;AACA;AAMA;AACA;AACA;AACA;AADA;AADA;AADA;AACA;AAQA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAGA;AACA;AADA;AACA;AAGA;AATA;AADA;AACA;AAcA;AACA;AACA;AACA;AADA;AAFA;AACA;AAOA;AACA;AACA;AADA;AACA;AAGA;AACA;AACA;AACA;AADA;AADA;AADA;AACA;AAOA;AACA;AACA;AACA;AADA;AADA;AADA;AAbA;AACA;AAsBA;AACA;AACA;AACA;AACA;AAFA;AADA;AADA;AACA;AASA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AADA;AAFA;AAJA;;;;;;ACpJA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AADA;AACA;AAIA;AACA;AACA;AACA;AACA;AADA;AACA;AAGA;AACA;AADA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AADA;AAIA;AACA;AAFA;AAIA;AAPA;AACA;AASA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AApCA;AANA;;;;","sourceRoot":""}