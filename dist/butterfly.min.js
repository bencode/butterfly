!function(a){function b(a){return d[a]}function c(a,c,f){if(d[a])throw"module already exist: "+a;if(f||(f=c,c=e),"function"==typeof f){for(var g=[],h=0,i=c.length;i>h;h++)g.push(b(c[h]));f=f.apply(null,g)}d[a]=f}var d={},e=[];c("origindefine",function(){return a.define}),c("global",function(){return a}),a.define=c,c._cache=d}("undefined"==typeof window?global:window),define("util",function(){var a=Object.prototype.toString,b=1,c={isArray:Array.isArray?Array.isArray:function(b){return"[object Array]"===a.call(b)},extend:function(a,b){for(var c in b){var d=b[c];null!==d&&void 0!==d&&(a[c]=d)}return a},each:function(a,b){var c=a.length,d=0===c||"number"==typeof c&&c>0&&c-1 in a;if(d)for(var e=0;c>e&&b(e,a[e])!==!1;e++);else for(var f in a)if(b(f,a[f])===!1)break},map:function(a,b){for(var c=[],d=0,e=a.length;e>d;d++){var f=b(d,a[d]);void 0!==f&&c.push(f)}return c},proxy:function(a,b){var c=a[b];return function(){return c.apply(a,arguments)}},assert:function(a,b){if(!a)throw new Error("AssertFailError: "+b)},guid:function(){return b++},when:function(a,b){var d=[],e=a.length,f=0,g=function(){f>=e&&b(d)};g(),c.each(a,function(a,b){b(function(b){d[a]=b,f++,g()})})}};return c}),define("log",["global","util"],function(a,b){var c={none:0,error:1,warn:2,info:3,debug:4},d=function(){var b=a.location,c=b?b.search:"";return(/\bdebug-log-level=(\w+)/.exec(c)||{})[1]||a.debugLogLevel||"error"}(),e=function(a,b){e.isEnabled(b)&&(a="[loader] "+a,e.handler(a,b))};e.level=d,e.isEnabled=function(a){return c[a]<=c[e.level]},b.each(c,function(a){e[a]=function(b){e(b,a)}});var f=a.console;return e.handler=f?function(a,b){f[b]?f[b](a):f.log&&f.log(a)}:function(){},e}),define("event",["util","log"],function(a,b){var c=[].slice;return function(a){var d={};return a=a||{},a.on=function(a,c){b.debug("event.on:"+a);var e=d[a]||(d[a]=[]);e.push(c)},a.trigger=function(e){b.debug("event.trigger:"+e);var f=d[e];if(f)for(var g=arguments.length>1?c.call(arguments,1):[],h=0,i=f.length;i>h;h++){var j=f[h].apply(a,g);if(null!==j&&void 0!==j)return j}},a.off=function(a,c){b.debug("event.off:"+a);var e=d[a];if(e){for(var f=e.length-1;f>=0;f--)e[f]===c&&e.splice(f,1);e.length||delete d[a]}},a}}),define("config",function(){var a={alias:!0,resolve:!0};return function(){var b={};this.get=function(c){return a[c]?b[c]||[]:b[c]},this.set=function(c,d){a[c]?(b[c]=b[c]||[],b[c].push(d)):b[c]=d}}}),define("define",["util","log"],function(a,b){function c(b,c,d){void 0!==d||f(c)||(d=c,c=g),"function"==typeof b?(d=b,c=g,b=null):f(b)&&(c=b,b=null),e(f(c),"arguments error, depends should be an array");var h=!b;return b=b||"____anonymous"+a.guid(),{id:b,depends:c,factory:d,anonymous:h}}var d=function(a){var d=a.modules;this.define=function(e,f,g){var h=c(e,f,g);return e=h.id,d[e]?(b.warn("module already defined, ignore: "+e),d[e]):(b.debug("define module: "+e),d[e]=h,a.trigger("define",h),h)}},e=a.assert,f=a.isArray,g=[];return d}),define("require",["util","log"],function(a,b){var c=a.assert;return function(d){function e(c,d){if(c.loadtimes>0)return c.loadtimes++,b.debug(c.id+" is loaded "+c.loadtimes+" times"),void d();var e=c.loadlist||(c.loadlist=[]);e.push(d),e.length>1||f(c,function(){g(c,function(){b.debug(c.id+" is loaded"),c.loadtimes=e.length,delete c.loadlist,a.each(e,function(a,b){b()})})})}function f(c,f){var g=c.depends;if(0===g.length)return f();var k=c.adepends=g.slice(0),l=a.map(g,function(a,c){return function(f){var g=j[c]||d.trigger("alias",c);g&&(b.debug("alias "+c+" -> "+g),c=g),j[c]=c,k[a]=c;var l=i[c],m=function(a){e(a,f)};l?m(l):h(c,m)}});a.when(l,f)}function g(e,f){d.trigger("compile",e);var g=e.factory;if("function"==typeof g){var h=e.adepends,j={id:e.id,exports:{}},k=[];h&&h.length&&a.each(h,function(a,b){var d=i[b];c(d&&"exports"in d,"module should already loaded: "+b),k[a]=d.exports&&"function"==typeof d.exports.$compile?d.exports.$compile(j,e):d.exports});try{b.debug("compile "+e.id),g=g.apply(null,k),void 0===g&&(g=j.exports)}catch(l){if(b.error(l.stack),d.trigger("error",l),b.isEnabled("info"))throw l}}e.exports=g,f()}function h(c,e){var f=k[c]||(k[c]=[]),g=function(a){var f=i[c];return f?(f.async=!0,f.url=a,void e(f)):void b.error("can not find module: "+d.namespace+":"+c)};if(f.push(g),!(f.length>1)){var h=d.trigger("resolve",c);if(!h)return void b.error("can not resolve module: "+d.namespace+":"+c);b.debug("resolve "+c+" -> "+h);var j={id:c,url:h,namespace:d.namespace};d.trigger("request",j,function(){delete k[c],a.each(f,function(a,b){b(h)})})}}var i=d.modules;this.require=function(b,c){b=a.isArray(b)?b:[b];var d={proxy:!0,id:"____require"+a.guid(),depends:b,factory:function(){return arguments}};return e(d,function(){c&&c.apply(null,d.exports)}),d.exports&&d.exports[0]};var j={},k={}}}),define("assets",["log"],function(a){function b(a,b){var c=!1;setTimeout(function(){c||(c=!0,b.error&&b.error())},b.timeout||1e4);var d=function(){var e=!1;try{e=!!a.sheet}catch(f){e=o.test(f.message)}c||(e?(c=!0,b.success&&b.success()):setTimeout(d,20))};d()}function c(b,c,d,e,f){b.onload=b.onreadystatechange=function(g){g=g||window.event||{},("load"===g.type||p.test(""+b.readyState))&&(b.onload=b.onreadystatechange=b.onerror=null,d&&r.removeChild(b),a.debug("load success: "+c),f&&f(),e.success&&e.success())},b.onerror=function(){b.onload=b.onreadystatechange=b.onerror=null,a.error("load error: "+c),e.error&&e.error()}}function d(a){s?r.insertBefore(a,s):r.appendChild(a)}var e=/\.css(\?|$)/,f={};f.postLoadScript=null,f.load=function(a,b){var c=e.test(a)?"css":"script";return f[c](a,b)};var g;f.script=function(b,e){a.debug("request script: "+b),e=e||{};var h=q.createElement("script"),i=!a.isEnabled("debug");c(h,b,i,e,function(){f.postLoadScript&&(f.postLoadScript(b,e),f.postLoadScript=null)}),h.async="async",e.namespace&&h.setAttribute("data-butterfly",e.namespace),h.src=b,e.charset&&(h.charset=e.charset),g=h,d(h),g=null};var h=/.*webkit\/?(\d+)\..*/,i=/mobile/,j=window.navigator.userAgent.toLowerCase(),k=h.exec(j),l=k?1*k[1]<536:!1,m=l||!k&&i.test(j);f.css=function(e,f){a.debug("request css: "+e),f=f||{};var g=q.createElement("link");g.rel="stylesheet",g.href=e,f.charset&&(g.charset=f.charset),"onload"in g&&!m?c(g,e,!1,f):setTimeout(function(){b(g,f)},1),d(g)};var n,o=/security|denied/i,p=/loaded|complete|undefined/,q=document,r=q.head||q.getElementsByTagName("head")[0]||q.documentElement,s=q.getElementsByTagName("base")[0];return f.getCurrentScript=function(){if(g)return g;if(n&&"interactive"===n.readyState)return n;for(var a=r.getElementsByTagName("script"),b=a.length-1;b>=0;b--){var c=a[b];if("interactive"===c.readyState)return n=c}},f}),define("request",["util","log","assets"],function(a,b,c){var d=/\.(css|js)(\?.*)?$/;return function(e){var f=e.modules;this.handle=function(g,h){var i=g.id,j=g.url,k=e.config("requestOptions");k="function"==typeof k?k(g):k,k=a.extend({id:i,namespace:g.namespace},k),k.success=function(){!f[i]&&d.test(i)&&(b.debug("define proxy module for:"+i),e.define(i),f[i].file=!0),h()},k.error=function(){e.trigger("requesterror",g)},c.load(j,k)}}}),define("loader",["global","util","log","event","config","define","require","request"],function(a,b,c,d,e,f,g,h){function i(a){var c=a.modules={};new d(a);var h=new e;a.config=function(a,b){return void 0===b?h.get(a):h.set(a,b)},a.define=b.proxy(new f(a),"define"),a.require=b.proxy(new g(a),"require"),a.hasDefine=function(a){return!!c[a]},a.getModules=function(){return c},a.resolve=function(b){return a.trigger("resolve",b)},a.undefine=function(a){delete c[a]}}function j(a){a.on("alias",function(b){return o(a.config("alias"),function(a,c){return"function"==typeof c?c(b):c[b]})})}function k(a){a.on("resolve",function(b){var c=o(a.config("resolve"),function(a,c){return c(b)});return!c&&q.test(b)&&(c=b),c})}function l(a){var b=h&&new h(a);a.on("request",function(c,d){var e=a.config("requestHandler");if(e)e(c,d);else{if(!b)throw new Error("no request handler found");b.handle(c,d)}})}function m(a){a.define("require",function(){return a.require}),a.define("module",function(){return{$compile:function(a){return a}}}),a.define("exports",function(){return{$compile:function(a){return a.exports}}})}function n(a){a.on("define",function(b){b.anonymous&&(c.debug("require anonymous module: "+b.id),a.require(b.id))})}function o(a,b){if(a&&0!==a.length)for(var c=0,d=a.length;d>c;c++){var e=b(c,a[c]);if(e)return e}}var p=function(b,c){var d=b,e=c||{};if(a[d])throw new Error("global."+d+" already exist.");a[d]=this,this.namespace=d,this.options=e,i(this),j(this),k(this),l(this),m(this),e.autoloadAnonymous&&n(this)},q=/(^\w*:\/\/)|(^[.\/])/;return p}),define("weave",["global","origindefine","util","loader"],function(a,b,c,d){var e=function(a,b){var c=new d(a,b);return e._modules[a]=c.modules,c},f=define;e._define=f,e._modules={},e.plugin=function(a,b,c){f("plugin/"+a,b,c)};var g=e("butterfly",{autoloadAnonymous:!0}),h=["config","on","off","define","require","hasDefine","getModules","resolve","undefine"];c.each(h,function(a,b){e[b]=g[b]}),e.define("global",function(){return a});var i=a.butterfly;a.butterfly=e,a.define=e.define,e.noConflict=function(){return a.define=b,a.butterfly=i,e}});